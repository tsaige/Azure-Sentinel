{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "a9e96138-5210-4bc3-9570-7e6b14fbb99e",
            "version": "KqlParameterItem/1.0",
            "name": "TimeframeParameter",
            "label": "Time frame",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 2592000000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2592000000
                }
              ],
              "allowCustom": true
            },
            "timeContext": {
              "durationMs": 86400000
            }
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "parameters - 0"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "FSecureElements\r\n| sort by TimeGenerated\r\n| project TimeGenerated, Activity\r\n| limit 250",
        "size": 1,
        "title": "Latest events for {TimeframeParameter:label}",
        "timeContext": {
          "durationMs": 2592000000
        },
        "timeContextFromParameter": "TimeframeParameter",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "gridSettings": {
          "filter": true
        },
        "sortBy": []
      },
      "customWidth": "25",
      "name": "query-2",
      "styleSettings": {
        "maxWidth": "50"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "FSecureElements\r\n| summarize count() by Activity\r\n| sort by Activity\r\n| render barchart\r\n",
        "size": 0,
        "title": "Events summary by type for {TimeframeParameter:label}",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeframeParameter",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "chartSettings": {
          "xAxis": "Activity"
        }
      },
      "customWidth": "75",
      "name": "query - 2",
      "styleSettings": {
        "maxWidth": "75"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "FSecureElements\r\n| make-series Events=count() default=0 on TimeGenerated from {TimeframeParameter:start} to {TimeframeParameter:end} step 15m\r\n| render timechart",
        "size": 0,
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeframeParameter",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "query - 3"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "FSecureElements\r\n| where isnotempty(InfectionType)\r\n| summarize count() by Computer\r\n| project-rename Infections=count_, \r\n                 Device=Computer\r\n| sort by Infections\r\n| limit 10\r\n",
        "size": 0,
        "title": "Top 10 infected devices for {TimeframeParameter:label}",
        "timeContext": {
          "durationMs": 2592000000
        },
        "timeContextFromParameter": "TimeframeParameter",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "Infections",
              "formatter": 8,
              "formatOptions": {
                "palette": "yellowOrangeRed"
              }
            }
          ]
        }
      },
      "customWidth": "33",
      "name": "query - 5",
      "styleSettings": {
        "maxWidth": "33"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "FSecureElements\r\n| where IsInfection == true\r\n| summarize count() by AccountName\r\n| project-rename Infections=count_\r\n| sort by Infections\r\n| limit 10",
        "size": 0,
        "title": "Top 10 infected customers for {TimeframeParameter:label}",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeframeParameter",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "Infections",
              "formatter": 8,
              "formatOptions": {
                "palette": "yellowOrangeRed"
              }
            }
          ]
        }
      },
      "customWidth": "33",
      "name": "query - 6",
      "styleSettings": {
        "maxWidth": "33"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "FSecureElements\r\n| where IsInfection == true\r\n| summarize count() by InfectionName, InfectionType\r\n| project-rename Number=count_\r\n| sort by Number\r\n| limit 10",
        "size": 0,
        "title": "Top 10 detected malwares for {TimeframeParameter:label}",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeframeParameter",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "Number",
              "formatter": 8,
              "formatOptions": {
                "palette": "yellowOrangeRed",
                "compositeBarSettings": {
                  "labelText": "",
                  "columnSettings": []
                }
              }
            }
          ]
        }
      },
      "customWidth": "33",
      "name": "query - 4",
      "styleSettings": {
        "maxWidth": "33"
      }
    }
  ],
  "fallbackResourceIds": [
    "/subscriptions/6551ffc5-d5a4-48c1-b85d-2e67be9f0f81/resourcegroups/azure-sentinel-testing/providers/microsoft.operationalinsights/workspaces/azure-sentinel"
  ],
  "fromTemplateId": "sentinel-UserWorkbook",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}